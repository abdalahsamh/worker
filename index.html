<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ù„</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        text-align: center;
      }
      .container {
        max-width: 800px;
        margin: auto;
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      input,
      select,
      button {
        padding: 8px;
        margin: 5px;
      }
      table {
        width: 100%;
        margin-top: 15px;
        border-collapse: collapse;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 8px;
      }
      th {
        background: #333;
        color: #fff;
      }
      .btn-danger {
        background: red;
        color: #fff;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 5px;
      }
      .btn-clear {
        background: #ff9800;
        color: #fff;
        border: none;
        padding: 8px 12px;
        margin: 5px;
        cursor: pointer;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ“’ Ù†Ø¸Ø§Ù… ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ù„</h1>

      <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
      <input type="number" id="hours" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª" />
      <input type="number" id="rate" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø©" />
      <select id="type">
        <option value="Ø¹Ø§Ø¯ÙŠ">Ø¹Ø§Ø¯ÙŠ</option>
        <option value="Ø³Ù‡Ø±">Ø³Ù‡Ø±</option>
      </select>
      <button onclick="addRecord()">â• Ø¥Ø¶Ø§ÙØ©</button>

      <!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
      <table>
        <thead>
          <tr>
            <th>Ø§Ù„ÙŠÙˆÙ…</th>
            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</th>
            <th>Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø©</th>
            <th>Ø§Ù„Ù†ÙˆØ¹</th>
            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>
            <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
          </tr>
        </thead>
        <tbody id="recordsTable"></tbody>
      </table>

      <!-- Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ -->
      <h3>ğŸ’° Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="total">0</span> Ø¬Ù†ÙŠÙ‡</h3>
      <button class="btn-clear" onclick="clearAll()">ğŸ—‘ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>

      <!-- Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© -->
      <h2>ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
      <canvas id="barChart"></canvas>
      <canvas id="pieChart"></canvas>
    </div>

    <script>
      let records = JSON.parse(localStorage.getItem("records")) || [];

      function addRecord() {
        let hours = parseFloat(document.getElementById("hours").value);
        let rate = parseFloat(document.getElementById("rate").value);
        let type = document.getElementById("type").value;
        let date = new Date().toLocaleDateString("ar-EG");

        if (!hours || !rate) return alert("âš  Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª ÙˆØ§Ù„Ø³Ø¹Ø±");

        let total = hours * rate;

        let record = { date, hours, rate, type, total };
        records.push(record);
        localStorage.setItem("records", JSON.stringify(records));
        renderTable();
      }

      function renderTable() {
        let table = document.getElementById("recordsTable");
        table.innerHTML = "";
        let totalAll = 0;

        records.forEach((rec, i) => {
          totalAll += rec.total;
          table.innerHTML += `
          <tr>
            <td>${rec.date}</td>
            <td>${rec.hours}</td>
            <td>${rec.rate}</td>
            <td>${rec.type}</td>
            <td>${rec.total}</td>
            <td><button class="btn-danger" onclick="deleteRecord(${i})">Ø­Ø°Ù</button></td>
          </tr>
        `;
        });

        document.getElementById("total").innerText = totalAll;
        updateCharts();
      }

      function deleteRecord(i) {
        records.splice(i, 1);
        localStorage.setItem("records", JSON.stringify(records));
        renderTable();
      }

      function clearAll() {
        if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")) {
          records = [];
          localStorage.removeItem("records");
          renderTable();
        }
      }

      // ====== Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ======
      let barCtx = document.getElementById("barChart").getContext("2d");
      let pieCtx = document.getElementById("pieChart").getContext("2d");

      let barChart = new Chart(barCtx, {
        type: "bar",
        data: {
          labels: [],
          datasets: [
            {
              label: "Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª",
              data: [],
              backgroundColor: "rgba(75,192,192,0.6)",
            },
          ],
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } },
      });

      let pieChart = new Chart(pieCtx, {
        type: "pie",
        data: {
          labels: ["Ø¹Ø§Ø¯ÙŠ", "Ø³Ù‡Ø±"],
          datasets: [{ data: [0, 0], backgroundColor: ["#4CAF50", "#FF5722"] }],
        },
        options: { responsive: true },
      });

      function updateCharts() {
        // Bar chart
        let days = {};
        records.forEach((r) => {
          days[r.date] = (days[r.date] || 0) + r.hours;
        });
        barChart.data.labels = Object.keys(days);
        barChart.data.datasets[0].data = Object.values(days);
        barChart.update();

        // Pie chart
        let normal = records
          .filter((r) => r.type === "Ø¹Ø§Ø¯ÙŠ")
          .reduce((a, b) => a + b.hours, 0);
        let night = records
          .filter((r) => r.type === "Ø³Ù‡Ø±")
          .reduce((a, b) => a + b.hours, 0);
        pieChart.data.datasets[0].data = [normal, night];
        pieChart.update();
      }

      // Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„
      renderTable();
    </script>
  </body>
</html>
